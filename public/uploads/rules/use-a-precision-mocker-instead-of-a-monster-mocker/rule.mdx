---
archivedreason: null
authors:
- title: Adam Stephensen
  url: https://ssw.com.au/people/adam-stephensen
- title: William Liebenberg
  url: https://ssw.com.au/people/william-liebenberg
created: 2013-02-05 13:03:59+00:00
createdBy: Tiago Araujo
createdByEmail: TiagoAraujo@ssw.com.au
guid: 927a0909-7880-4b30-9c0c-f2ff65110905
isArchived: false
lastUpdated: 2019-07-30 00:29:11+00:00
lastUpdatedBy: Tiago Araujo
lastUpdatedByEmail: TiagoAraujo@ssw.com.au
redirects:
- do-you-use-a-precision-mocker-like-moq-instead-of-a-monster-mocker-like-microsoft-fakes
- do-you-use-a-precision-mocker’-like-moq-instead-of-a-monster-mocker’-like-microsoft-fakes
seoDescription: Do you use a precision mocker like NSubstitute instead of a monster
  mocker like Microsoft Fakes to write maintainable and loosely coupled code?
title: Do you use a ‘Precision Mocker’ like NSubstitute instead of a ‘Monster Mocker’
  like Microsoft Fakes?
categories:
  - category: categories/software-engineering/rules-to-better-architecture-and-code-review.mdx
type: rule
uri: use-a-precision-mocker-instead-of-a-monster-mocker
---

Using a precision mocking framework (such as [NSubstitute](https://nsubstitute.github.io/)) encourages developers to write maintainable, loosely coupled code.

Mocking frameworks allow you to replace a section of the code you are about to test, with an alternative piece of code.
For example, this allows you to test a method that performs a calculation and saves to the database, without actually requiring a database.

<endIntro />

There are two types of mocking framework.

### The Monster Mocker (e.g. Microsoft Fakes or TypeMock)

This type of mocking framework is very powerful and allows replacing code that wasn’t designed to be replaced.
This is great for testing legacy code, tightly coupled code with lots of static dependencies (like DateTime.Now) and SharePoint.

<imageEmbed
  alt="Image"
  size="large"
  showBorder={false}
  figurePrefix="bad"
  figure="Bad Example – Our class is tightly coupled to our authentication provider, and as we add each test we are adding *more* dependencies on this provider. This makes our codebase less and less maintainable. If we ever want to change our authentication provider “OAuthWebSecurity”, it will need to be changed in the controller, and every test that calls it"
  src="/uploads/rules/use-a-precision-mocker-instead-of-a-monster-mocker/monster-mocker.jpg"
/>


### The Precision Mocker (e.g. NSubstitute)

This mocking framework takes advantage of well written, loosely coupled code.

The mocking framework creates substitute items to inject into the code under test.

<imageEmbed
  alt="Image"
  size="large"
  showBorder={false}
  figurePrefix="good"
  figure="Good Example - An interface describes the methods available on the provider"
  src="/uploads/rules/use-a-precision-mocker-instead-of-a-monster-mocker/nsubstitute-1.png"
/>


<imageEmbed
  alt="Image"
  size="large"
  showBorder={false}
  figurePrefix="good"
  figure="Good Example - The Product Repository is injected into the ProductService class (via constructor injection)"
  src="/uploads/rules/use-a-precision-mocker-instead-of-a-monster-mocker/nsubstitute-2.png"
/>


<imageEmbed
  alt="Image"
  size="large"
  showBorder={false}
  figurePrefix="good"
  figure="Good Example - The code is loosely coupled. The ProductService is dependent on an interface of the Product Repository, which is injected into the ProductService via its constructor. The unit test can easily create a mock object of the Product Repository and substitute it for the dependency. NSubstitute is one of the most popular mocking libraries."
  src="/uploads/rules/use-a-precision-mocker-instead-of-a-monster-mocker/nsubstitute-3.png"
/>