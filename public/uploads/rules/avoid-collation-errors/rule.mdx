---
archivedreason: null
authors:
- title: Adam Cogan
  url: https://ssw.com.au/people/adam-cogan
categories:
- category: categories/software-engineering/rules-to-better-sql-databases-admin.mdx
created: 2019-11-22 22:54:08+00:00
createdBy: TiagoAraujo
createdByEmail: TiagoAraujo@ssw.com.au
guid: 90c305f6-40d8-4bab-a049-12108957754f
isArchived: false
lastUpdated: 2024-06-11 00:27:00+00:00
lastUpdatedBy: Brady Stroud [SSW]
lastUpdatedByEmail: bradystroud@ssw.com.au
redirects:
- dbas-do-you-avoid-collation-errors
seoDescription: Avoid collation errors by specifying database default collation when
  joining tables or creating temporary tables.
title: DBAs - Do you avoid collation errors?
type: rule
uri: avoid-collation-errors
---

You don't want this error:


<asideEmbed
  variant="greybox"
  body={<>
    "120_ClientInvoice_ClientIDRequired.sql...Column 'dbo.Client.ClientID' is not of same collation as referencing column 'ClientInvoice.ClientID' in foreig..."
  </>}
  figureEmbed={{
    preset: "default",
    figure: "XXX",
    shouldDisplay: false
  }}
/>

When you write a stored proc - it must work regardless of the users collation. When you are joining to a temp table - meaning you are joining 2 different databases (eg. Northwind and TempDB) they won't always have the same collation.

The reality is that you can't tell a user what collation to run their TempDB - we can only specify the collation Northwind should be (we don't even want to specify that - we want that to be their default (as per their server)).

<endOfIntro />

Here is what you need to do:

```sql
SELECT
 #ClientSummary.ClientID,
 DateOfLastReminder = MAX(ClientDiary.DateCreated),
 DaysSinceLastReminder = DATEDIFF(day,MAX(ClientDiary.DateCreated),getdate())
 INTO #RecentReminderList
 FROM
 ClientDiary INNER JOIN #ClientSummary
 ON ClientDiary.ClientID = #ClientSummary.ClientID COLLATE
 database_default
 WHERE
 ClientDiary.CategoryID LIKE 'DEBT-%'
 GROUP BY
 #ClientSummary.ClientID
```