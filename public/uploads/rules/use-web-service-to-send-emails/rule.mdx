---
seoDescription: Use a Web Service to securely send emails from your Windows application without storing email server configurations.
type: rule
title: Do you use Web Service to send emails?
uri: use-web-service-to-send-emails
authors:
  - title: Adam Cogan
    url: https://ssw.com.au/people/adam-cogan/
created: 2024-03-25T20:34:43.000Z
guid: df81ed0a-c8a1-46bf-82ea-892929c7191f
lastUpdated: 2024-03-25T20:34:43.000Z
lastUpdatedBy: Igor Goldobin
lastUpdatedByEmail: igor.goldobin@gmail.com
createdBy: Igor Goldobin
createdByEmail: igor.goldobin@gmail.com
---

<introEmbed
  body={<>
In a Windows application, if you need to send mail, please use a WebService to do this, because using WebService to send emails is safer.You don't need to store the email server configuration in your application.config file, which can be installed on the client and be exposed to someone who could take advantage of it.
  </>}
/>
```cs
SmtpClient client = new SmtpClient();
try
{
    client.Host = "****.***.com.au";
    client.Port = 25;
    client.UseDefaultCredentials = true;

    MailAddress from = new MailAddress("test@ssw.com.au");

    string unrecAddy = "test@ssw.com.au";
    MailAddress to = new MailAddress(unrecAddy);

    MailMessage mailMessage = new MailMessage(from, to);

    mailMessage.Subject = "aaa";
    string strVer = "aaa";
    mailMessage.Body = "aaa";

    client.Send(mailMessage);

}
catch(Exception ex)
{
    client.SendAsyncCancel();
    MessageBox.Show(ex.ToString());
}
```

<figureEmbed figureEmbed={{
  preset: "badExample",
  figure: 'Bad example - Send mail without webservice',
  shouldDisplay: true
} } />


```cs
Emailer.PubicFunction pf = new EmailWebServices.Emailer.Publiction();
pf.SendMail("Test", textBox3.Text, textBox1.Text, textBox2.Text, false, "", null);
```

<figureEmbed figureEmbed={{
  preset: "goodExample",
  figure: 'Good example - Send mail use webservice',
  shouldDisplay: true
} } />
