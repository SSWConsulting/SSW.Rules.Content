---
seoDescription: Code duplication detection and refactoring improves maintainability by minimizing repeated code snippets. By extracting common logic into reusable methods, developers can reduce code complexity and enhance overall system performance.
type: rule
title: Do you look for duplicate code?
uri: do-you-look-for-duplicate-code
authors:
  - title: Adam Cogan
    url: https://ssw.com.au/people/adam-cogan
  - title: Damian Brady
    url: https://ssw.com.au/people/damian-brady
related: []
redirects: []
created: 2012-04-01T09:57:11.000Z
archivedreason: null
guid: 2c1f0b48-dc84-48ac-8255-0ffb0e4821d6
lastUpdated: 2024-06-08T03:27:17.000Z
lastUpdatedBy: Brady Stroud [SSW]
lastUpdatedByEmail: bradystroud@ssw.com.au
createdBy: LuZhang
createdByEmail: LuZhang@ssw.com.au
isArchived: false
---

<introEmbed
  body={<>
Code duplication is a big "code smell" that harms maintainability. You should keep an eye out for repeated code and make sure you refactor it into a single place.
  </>}
/>
For example, have a look at these two Action methods in an MVC 4 controller.

```csharp
//
// GET: /Person/
[Authorize]
public ActionResult Index()
{
    // get company this user can view
    Company company = null;
    var currentUser = Session["CurrentUser"] as User;
    if (currentUser != null)
    {
        company = currentUser.Company;
    }

    // show people in that company
    if (company != null)
    {
        var people = db.People.Where(p => p.Company == company);
        return View(people);
    }
    else
    {
        return View(new List());
    }
}

//
// GET: /Person/Details/5
[Authorize]
public ActionResult Details(int id = 0)
{
    // get company this user can view
    Company company = null;
    var currentUser = Session["CurrentUser"] as User;
    if (currentUser != null)
    {
        company = currentUser.Company;
    }

    // get matching person
    Person person = db.People.Find(id);
    if (person == null || person.Company == company)
    {
        return HttpNotFound();
    }
    return View(person);
}
```

<figureEmbed figureEmbed={ {
  preset: "badExample",
  figure: "Figure: Bad Example - The highlighted code is repeated and represents a potential maintenance issue.",
  shouldDisplay: true
} } />


We can refactor this code to make sure the repeated lines are only in one place.

```csharp
private Company GetCurrentUserCompany()
{
    // get company this user can view
    Company company = null;
    var currentUser = Session["CurrentUser"] as User;
    if (currentUser != null)
    {
        company = currentUser.Company;
    }
    return company;
}

//
// GET: /Person/
[Authorize]
public ActionResult Index()
{
    // get company this user can view
    Company company = GetCurrentUserCompany();

    // show people in that company
    if (company != null)
    {
        var people = db.People.Where(p => p.Company == company);
        return View(people);
    }
    else
    {
        return View(new List());
    }
}


// GET: /Person/Details/5
[Authorize]
public ActionResult Details(int id = 0)
{
    // get company this user can view
    Company company = GetCurrentUserCompany();

    // get matching person
    Person person = db.People.Find(id);
    if (person == null || person.Company == company)
    {
        return HttpNotFound();
    }
    return View(person);
}
```

<figureEmbed figureEmbed={ {
  preset: "goodExample",
  figure: "Figure: Good Example - The repeated code has been refactored into its own method.",
  shouldDisplay: true
} } />


**Tip:** The Refactor menu in Visual Studio 11 can do this refactoring for you.

<imageEmbed
  alt="Image"
  size="large"
  showBorder={false}
  figureEmbed={ {
    preset: "default",
    figure: "The Extract Method function in Visual Studio's Refactor menu",
    shouldDisplay: true
  } }
  src="/uploads/rules/do-you-look-for-duplicate-code/vs_refactor_extract.png"
/>
