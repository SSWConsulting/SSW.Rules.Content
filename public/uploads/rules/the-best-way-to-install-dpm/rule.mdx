---
seoDescription: Install DPM best practices include using Windows Server 2012 R2 to avoid ReFS file structure issues and ensure efficient backups.
type: rule
archivedreason:
title: Do you know the best way to install DPM?
guid: 2c39840c-6e01-4707-8106-b62d287b18b1
uri: the-best-way-to-install-dpm
created: 2011-06-15T02:33:45.000Z
authors:
  - title: Matthew Hodgkins
    url: https://ssw.com.au/people/matthew-hodgkins
  - title: Steven Andrews
    url: https://ssw.com.au/people/steven-andrews
  - title: Sumesh Ghimire
    url: https://ssw.com.au/people/sumesh-ghimire
related: []
redirects:
  - do-you-know-the-limitations-when-installing-dpm-as-a-virtual-machine
  - do-you-know-the-best-way-to-install-dpm
lastUpdated: 2024-01-31T18:37:29.000Z
lastUpdatedBy: Tom Bui [SSW]
lastUpdatedByEmail: 67776356+tombui99@users.noreply.github.com
createdBy: Unknown
createdByEmail: Unknown@ssw.com.au
---

<introEmbed
  body={<>
It might make sense in your environment to install a DPM Server inside a Virtual Machine. While it is supported by Microsoft, there are a few limitations you need to be aware of.
  </>}
/>
- The Hyper-V role cannot be installed on the DPM server when it has been virtualized. This prevents you doing item level restores from inside Hyper-V virtual machines
- You are unable to use hardware tape libraries inside the Virtual Machine. You are still able to use iSCSI or Virtual Tape libraries though
- Storage of your backups should not be on the SAN where you are running all of your servers

Further to this, it is also recommend that you use iSCSI or Pass-Through disks if you are going to be using DPM inside a Virtual Machine. Using VHD’s in the storage pool is going to give you poor performance.

<asideEmbed
  variant="greybox"
  body={<>
    
**WARNING:** Although Microsoft recommend running the latest OS (being Windows Server 2019 and DPM 2019). SSW recommends Windows Server 2012 R2 with DPM 2019.

The reason for this is currently there are some known issues with the use of ReFS files structure in current versions of DPM (2016/2019). When installed on Windows Server 2016 and 2019 ReFS is used as default and there is no option given to use another file structure. The issues are causing backups to take exceptionally long times and in a lot of cases failing. E.g:

- Exchange VM taking 100+ hours to backup and then failing when running Windows 2016 and DPM 2016
- Exchange VM taking &lt;3 hours to backup when running Windows 2012 R2 and DPM 2019

Microsoft have released many updates to fix ReFS but people are still seeing issues, so it is recommended until this is resolved to continue operating DPM on Windows Server 2012 R2 as it allows you to continue using NTFS which is working without issues.
  </>}
  figureEmbed={{
    preset: "default",
    figure: 'XXX',
    shouldDisplay: false
  }}
/>
