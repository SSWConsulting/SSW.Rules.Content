---
type: rule
title: Do you parameterize all input to your database?
uri: do-you-parameterize-all-input-to-your-database
created: 2020-03-18T23:01:46.0000000Z
authors:
- id: 99
  title: Christian Morford-Waite

---



<span class='intro'> It is important to parameterize all input to your database and it’s easy to implement.<br>Doing so will also reduce a lot of headaches down the track.<div><br>&#160;<img src="ParameterizeSqlInputsXKCD.png" alt="ParameterizeSqlInputsXKCD.png" style="margin&#58;5px;" /><dd class="ssw15-rteElement-FigureNormal">Figure&#58; What can happen if you don’t parameterize your inputs<br>Source&#58;&#160;<a href="https&#58;//xkcd.com/327/">xkcd.com​</a><br></dd></div> </span>

<p class="ssw15-rteElement-P">​​<br></p><dd class="ssw15-rteElement-FigureGood">​Advantages<br></dd><ul><li>​Prevents SQL injection attacks</li><li>Preserves types being sent to the database</li><li>Increased performance by reducing the number of query plans</li><li>Makes your code more readable<br></li></ul><p class="ssw15-rteElement-CodeArea">​SELECT Id, CompanyName, ContactName, ContactTitle<br>FROM dbo.Customers<br>WHERE CompanyName = 'NorthWind';<br></p><dd class="ssw15-rteElement-FigureBad">​Figure&#58; Bad Example - Using a dynamic SQL query<br></dd><p class="ssw15-rteElement-CodeArea">SELECT Id, CompanyName, ContactName, ContactTitle<br>FROM dbo.Customers<br>WHERE CompanyName = @companyName;<br></p><dd class="ssw15-rteElement-FigureGood">​Figure&#58; Good Example - Using a parameterized query​<br></dd><h3 class="ssw15-rteElement-H3">​​Should I use Parameters.AddWithValue()?<br></h3><p>Using Parameters.AddWithValue() can be a bit of a shortcut as you don’t need to specify a type. However shortcuts often have their dangers and this one certainly does.<br><br>For most cases <a href="https&#58;//docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlparametercollection.addwithvalue?view=netframework-4.8">Parameters.AddWithValue()</a>&#160;will guess correctly, but sometimes it doesn’t which can lead to the value being misinterpreted when sent to the database.&#160;This can be avoided using <a href="https&#58;//docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlparametercollection.add?view=netframework-4.8">Parameters.Add()</a> and specifying the <a href="https&#58;//docs.microsoft.com/en-us/dotnet/api/system.data.sqldbtype?view=netframework-4.8">SqlDbType</a>, this will ensure the data will reach the database in the correct form.​<br></p><p class="ssw15-rteElement-P">When using dates, strings, varchar and nvarchar it is strongly recommended to use <strong>Parameters.Add()</strong> as there is a possibility of <strong>Parameters.AddWithValue()</strong> to incorrectly guess the type.&#160;<br></p><p>​<span style="color&#58;#cc4141;font-family&#58;&quot;segoe ui&quot;, &quot;trebuchet ms&quot;, tahoma, arial, verdana, sans-serif;font-size&#58;18px;">​​</span><span style="color&#58;#cc4141;font-family&#58;&quot;segoe ui&quot;, &quot;trebuchet ms&quot;, tahoma, arial, verdana, sans-serif;font-size&#58;18px;">​Implementing parameterized queries using Parameters.Add()</span></p><p class="ssw15-rteElement-CodeArea">cmd.Parameters.Add(&quot;@varcharValue&quot;, System.Data.SqlDbType.Varchar, 20).Value = “Text”;<br></p><dd class="ssw15-rteElement-FigureGood">​​Figure&#58; Good Example – Using VarChar SqlDbType and specifying a max of 20 characters (-1 for MAX)<br></dd><p class="ssw15-rteElement-CodeArea">cmd.Parameters.Add(&quot;@decimalValue&quot;, System.Data.SqlDbType.Decimal, 11, 4).Value = decimalValue;<br></p><dd class="ssw15-rteElement-FigureGood">​Figure&#58; Good Example – Using decimal(11,4) SQL Parameter<br></dd><p class="ssw15-rteElement-CodeArea">​​cmd.Parameters.Add(&quot;@dateTimeValue&quot;, System.Data.SqlDbType.DateTime2).Value = DateTime.UtcNow;<br></p><dd class="ssw15-rteElement-FigureGood">​Figure&#58; Good Example - C#, VB .NET SQL DateTime Parameter<br></dd><p class="ssw15-rteElement-CodeArea">​$SqlCmd.Parameters.Add(&quot;@dateTimeValue&quot;, [System.Data.SqlDbType]&#58;&#58;DateTime2).Value = $dateTime2Value<br></p><dd class="ssw15-rteElement-FigureGood">​Figure&#58; Good Example - PowerShell SQL DateTime Parameter<br></dd><p></p>


