---
type: rule
title: Do you use Asynchronous method and CallBack when invoke web method?
uri: do-you-use-asynchronous-method-and-callback-when-invoke-web-method
created: 2009-05-13T07:06:50.0000000Z
authors:
- id: 1
  title: Adam Cogan
- id: 17
  title: Ryan Tee

---



<span class='intro'> Web service and web invoking becomes more and more popular today as the distributed systems are widely deployed. However, the normal method invoking may cause a disaster when apply to web method because transmitting data over Internet may cause your program to hang for a couple of minutes. 
 </span>


  <dl class="badCode">
    <dt style="width&#58;91.56%;height&#58;174px;">private static string LoadContentFromWeb(string strUri) <br>
    <br>
    &#123; <br>
    ... <br>
    <br>
    <span style="background-color&#58;#ffff00;">WebResponse response = request.GetResponse(); </span><br>
    <br>
    ...<br>
    &#125; </dt>
    <dd>Figure&#58; Invoke web method by the normal way (Bad - because this will hang your UI thread) </dd>
</dl>
<p>The correct way to invoke web method is using asynchronous call to send a request and use the delegated CallBack method to read the response, see code below&#58;</p>
<dl class="goodCode">
    <dt style="width&#58;91.4%;height&#58;660px;">&#160;public static void GetOnlineVersionAsync(string strUri) <br>
    &#123; <br>
    &#160;&#160;&#160; try<br>
    &#160;&#160;&#160; &#123;<br>
    &#160;&#160;&#160;&#160; ...<br>
    <br>
    &#160;&#160;&#160;&#160;&#160;&#160;&#160; <span style="background-color&#58;#ffff00;">IAsyncResult r = request.BeginGetResponse(new AsyncCallback(ResCallBack), request);</span><br>
    &#160;&#160;&#160;&#160; &#125;<br>
    &#160;&#160;&#160;&#160; catch(WebException ex)<br>
    &#160;&#160;&#160; &#123;<br>
    &#160;&#160;&#160;&#160;&#160;&#160;&#160; Console.WriteLine(ex.ToString()) ; <br>
    &#160;&#160;&#160;&#160; &#125;<br>
    &#125;<br>
    <br>
    <br>
    <br>
    private static void ResCallBack(IAsyncResult ar)<br>
    &#123;<br>
    &#160;&#160; try<br>
    &#160;&#160; &#123;<br>
    <span style="background-color&#58;#ffff00;">&#160;&#160;&#160;&#160;&#160; string content = string.Empty;<br>
    &#160;&#160;&#160;&#160;&#160; WebRequest req = (WebRequest)ar.AsyncState;<br>
    &#160;&#160;&#160;&#160;&#160; WebResponse response = req.EndGetResponse(ar);</span><br>
    <br>
    &#160;&#160;&#160;&#160;&#160; ...<br>
    <br>
    &#160;&#160;&#160;&#160;&#160; RaiseOnProductUpdateResult(content);<br>
    <br>
    &#160;&#160; &#125;<br>
    &#160;&#160; catch(WebException ex)<br>
    &#160;&#160; &#123;<br>
    &#160;&#160;&#160;&#160;&#160; Console.WriteLine(ex.ToString());<br>
    &#160;&#160;&#160;&#160;&#160; RaiseOnProductUpdateResult(string.Empty);<br>
    &#160;&#160;&#160; &#125;<br>
    &#125; </dt>
    <dd>Figure&#58; Invoke web method by using asynchronous method and CallBack (Good - UI thread will be free once the request has been sent) </dd>
</dl>
<p>When working with Web Service, asynchronous methods will be automatically generated by your web services proxy.</p>
<dl class="image">
    <dt><img alt="" style="border-bottom&#58;0px solid;border-left&#58;0px solid;border-top&#58;0px solid;border-right&#58;0px solid;" border="0" src="AsyncCallBack-Rulest1.gif" /> </dt>
    <dd>Figure&#58; Automatically generated asynchronous methods</dd>
</dl>



